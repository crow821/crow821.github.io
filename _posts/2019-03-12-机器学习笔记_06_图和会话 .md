---
title: 机器学习笔记_06_图和会话
categories:
- ML
tags:
- tensorflow
updated: 2019-03-12
---



 

笔记来源：培训视频       tensorflow_图和会话

<img src="{{ site.url }}/assets//blog_images/ML/图和会话_01.png" />

最简单的tensorflow程序：

```python
# coding: utf-8
import tensorflow as tf
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'  # 保证在编译的时候可以将警告关掉
a = tf.constant(5.0)
b = tf.constant(6.0)
sum1 = tf.add(a, b)
print(sum1) # 输出结果是 Tensor("Add:0", shape=(), dtype=float32)

with tf.Session() as sess:
    print(sess.run(sum1))  # 输出结果是 ：11.0
```

关于默认图：

```python
# coding: utf-8
# coding: utf-8
import tensorflow as tf
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'  # 保证在编译的时候可以将警告关掉
a = tf.constant(5.0)
b = tf.constant(6.0)
sum1 = tf.add(a, b)
# 默认的这张图，相当于是给程序分配一段内存
graph = tf.get_default_graph() # 输出：<tensorflow.python.framework.ops.Graph object at 0x
                                    # 00000165002A8AC8>
print(graph)

with tf.Session() as sess:
    print(sess.run(sum1))
    print(a.graph)
    print(sum1.graph)
    print(sess.graph)
"""
<tensorflow.python.framework.ops.Graph object at 0x000001BEBE828AC8>
<tensorflow.python.framework.ops.Graph object at 0x000001BEBE828AC8>
<tensorflow.python.framework.ops.Graph object at 0x000001BEBE828AC8>
三个地址在同一个地方
"""


```

<img src="{{ site.url }}/assets//blog_images/ML/图和会话_02.png" />

创建一张图：

```python

# coding: utf-8
import tensorflow as tf
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'  # 保证在编译的时候可以将警告关掉
# 创建一张图包含了一组op和tensor，上下文环境
# op：只要是在tensorflow的API定义的函数都是OP
# tensor： 就指代的是数据
g = tf.Graph()
print(g)
with g.as_default():
    c = tf.constant(11.0)
    print(c.graph)

'''
<tensorflow.python.framework.ops.Graph object at 0x000001A2D52FEA58>
<tensorflow.python.framework.ops.Graph object at 0x000001A2D52FEA58>

'''
```

tensorflow：前端系统： 定义程序的图的结构

​			后端系统：运算图结构

会话： 1. 运行图的结构

​	    2.分配资源计算

​	    3.掌握资源（变量的资源，队列，线程）

```python
# 只能运行一个图，可以在会话中指定图去运行
with tf.Session(graph=g) as sess:  # 可以之定义图为g，如果不指定，直接为空即可
    sess.run()  # 相当于启动整个图
```

```python
with tf.Session(config=tf.ConfigProto(log_device_placement=True)) as sess:
    print(sess.run(sum1))
    """
   config=tf.ConfigProto(log_device_placement=True的作用就是显示谁产参与了运算等
   结果如下：
Add: (Add): /job:localhost/replica:0/task:0/device:CPU:0
Const: (Const): /job:localhost/replica:0/task:0/device:CPU:0
Const_1: (Const): /job:localhost/replica:0/task:0/device:CPU:0

""""""
```

只要有会话的上下文环境，就可以使用eval()

**会话中的run()方法：**

`run(fetches, feed_dict= None,graph=None)`     运行ops和计算tensor

placeholder是一个占位符

```python
# placeholder是一个占位符,feed_dict是一个字典
plt =  tf.placeholder(tf.float32, [2,3])
with tf.Session() as sess:
    print(sess.run(plt, feed_dict={plt: [[1,2,3], [4,5,6]]})) # feed_dict传入的是一个字典文件
"""
[[1. 2. 3.]
 [4. 5. 6.]]

"""
```



```python
plt =  tf.placeholder(tf.float32, [None,3]) # 代表的是不确定行，3列的数据
```



































