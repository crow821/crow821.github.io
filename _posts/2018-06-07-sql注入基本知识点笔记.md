---
title: sql注入基本知识点笔记
categories:
- sql
tags:
- sql注入
updated: 2018-06-07
---



做sqli-labs的时候，发现中间还是有很多东西的欠缺，所以现在结合网上的知识点，重新好好学习一下，sql注入个人感觉好难，需要的东西比较多，还是好好学吧，反复的看，加油！（学习的部分教程转自http://www.cnblogs.com/lcamry/p/5763154.html）

**介绍几个常用函数：**

在注入中，用到比较多的几个函数介绍：

 1. version()——MySQL版本

 2. user()——数据库用户名 

 3. database()——数据库名 

 4. @@datadir——数据库路径 

 5. @@version_compile_os——操作系统版本 

     

    **1.字符串连接函数**

    函数具体介绍  http://www.cnblogs.com/lcamry/p/5715634.html

    2.concat(str1,str2,...)——没有分隔符地连接字符串 

    concat_ws(separator,str1,str2,...)——含有分隔符地连接字符串 

    group_concat(str1,str2,...)——连接一个组的所有字符串，并以逗号分隔每一条数据 说着比较抽象，

    其实也并不需要详细了解，知道这三个函数能一次性查出所有信息就行了 

**一般用于尝试的语句**

Ps:--+可以用#替换，url提交过程中Url编码后的#为%23

or 1=1--+

'or 1=1--+

"or 1=1--+

)or 1=1--+

')or 1=1--+

") or 1=1--+

"))or 1=1--+

一般的代码为：

id=id=_GET['id'];

$sql="SELECT * FROM users WHERE id='$id' LIMIT 0,1";

此处考虑两个点，一个是闭合前面你的 ' 另一个是处理后面的 ' ，一般采用两种思路，闭合后面的引号或者注释掉，注释掉采用--+ 或者 #（%23）     --------------------------（一般waf会将这个全部kill的）

**union操作符的介绍**

UNION 操作符用于合并两个或多个 SELECT 语句的结果集。请注意，UNION 内部的 SELECT 语句必须拥有相同数量的列。列也必须拥有相似的数据类型。同时，每条 SELECT 语句中的列的顺序必须相同。

**SQL UNION 语法**

SELECT column_name(s) FROM table_name1

UNION

SELECT column_name(s) FROM table_name2

注释：默认地，UNION 操作符选取不同的值。如果允许重复的值，请使用 UNION ALL。

**SQL UNION ALL 语法**

SELECT column_name(s) FROM table_name1

UNION ALL

SELECT column_name(s) FROM table_name2

另外，UNION 结果集中的列名总是等于 UNION 中第一个 SELECT 语句中的列名。

**sql中的逻辑运算** 

Select * from users where id=1 and 1=1; 这条语句能够选择出id=1的内容，and 1=1到底起作用了没有？这里就要清楚sql语句执行顺序了。

同时这个问题我们在使用万能密码的时候会用到。

Select * from admin where username='admin' and password='admin'

我们可以用 'or 1=1# 作为密码输入。原因是为什么？

这里涉及到一个逻辑运算，当使用上述所谓的万能密码后，构成的sql语句为：

Select * from admin where username='admin' and password=''or 1=1#'

Explain:上面的这个语句执行后，我们在不知道密码的情况下就登录到了admin用户了。

原因是在where子句后，我们可以看到三个条件语句 **username='admin**' and **password=''**or **1=1。**三个条件用and和or进行连接。在sql中，我们and的运算优先级大于or的元算优先级。因此可以看到 第一个条件（用a表示）是真的，第二个条件（用b表示）是假的，a and b = false,第一个条件和第二个条件执行and后是假，再与第三个条件or运算，因为第三个条件1=1是恒成立的，所以结果自然就为真了。因此上述的语句就是恒真了。



①Select * from users where id=1 and 1=1;

②Select * from users where id=1 && 1=1;

③Select * from users where id=1 & 1=1;

上述三者有什么区别？①和②是一样的，表达的意思是 id=1条件和1=1条件进行与运算。

③的意思是id=1条件与1进行&位操作，id=1被当作true，与1进行 & 运算 结果还是1，再进行=操作，1=1,还是1（ps：&的优先级大于=）

Ps:此处进行的位运算。我们可以将数转换为二进制再进行与、或、非、异或等运算。必要的时候可以利用该方法进行注入结果。例如将某一字符转换为ascii码后，可以分别与1,2,4,8,16,32.。。。进行与运算，可以得到每一位的值，拼接起来就是ascii码值。再从ascii值反推回字符。（运用较少）








